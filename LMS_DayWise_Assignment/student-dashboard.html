<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Student Dashboard</a>
            <a class="btn btn-danger" href="logout.html">Logout</a>
        </div>
    </nav>
    <div class="container mt-5">
        <h2 id="welcomeMsg"></h2>
    </div>
    <div class="container mt-4">
        <h3>Course Cart</h3>
        <form id="addCourseForm" class="mb-2">
            <input id="courseName" class="form-control mb-2" placeholder="Course Name" required>
            <button class="btn btn-success">Add to Cart</button>
        </form>
        <ul id="courseCartList" class="list-group"></ul>
    </div>
    <script>
        const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
        if(currentUser && currentUser.role === 'student'){
            document.getElementById('welcomeMsg').textContent = `Welcome, ${currentUser.name}!`;
        } else {
            window.location.href = 'login.html';
        }

        let cart = JSON.parse(localStorage.getItem('courseCart_' + currentUser.email)) || [];

        function updateCart() {
            const ul = document.getElementById('courseCartList');
            ul.innerHTML = '';
            cart.forEach((course, idx) => {
                let li = document.createElement('li');
                li.textContent = course;
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                let btn = document.createElement('button');
                btn.textContent = 'Remove';
                btn.className = 'btn btn-danger btn-sm';
                btn.onclick = () => {
                    cart.splice(idx, 1);
                    localStorage.setItem('courseCart_' + currentUser.email, JSON.stringify(cart));
                    updateCart();
                };
                li.appendChild(btn);
                ul.appendChild(li);
            });
        }

        document.getElementById('addCourseForm').onsubmit = (e) => {
            e.preventDefault();
            let course = document.getElementById('courseName').value.trim();
            if(course){
                cart.push(course);
                localStorage.setItem('courseCart_' + currentUser.email, JSON.stringify(cart));
                updateCart();
                document.getElementById('courseName').value = '';
            }
        };

        updateCart();
    </script>
</body>
</html>
